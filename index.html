<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Golf Mood Forecast</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <style>
            
            @import url('https://fonts.googleapis.com/css2?family=Sour+Gummy:ital,wght@0,100..900;1,100..900&display=swap');

            body {
                background-image: none;
                font-family: "Sour Gummy", sans-serif;
                font-optical-sizing: auto;
                font-style: normal;
                font-variation-settings:
                    "wdth" 100;
                text-align: center;
                margin: 0;
            }

            #moodImg {
                max-width: 300px; 
                display: none;
                margin: 1em auto 0 auto;
            }

            input {
                font-family: "Sour Gummy", sans-serif;
                font-optical-sizing: auto;
                font-style: normal;
                font-variation-settings:
                    "wdth" 100;
                text-align: center;
            }

            button {
                font-family: "Sour Gummy", sans-serif;
                font-optical-sizing: auto;
                font-style: normal;
                font-variation-settings:
                    "wdth" 100;
                text-align: center;
            }

            input, button, p {
                margin-bottom: 1em;
            }

            #content {
                background-color: white;
                width: 600px;        
                height: 100vh;      
                margin: 0 auto;       
                border-left: 4px dotted darkblue;   
                border-right: 4px dotted darkblue; 
                box-sizing: border-box;
                padding: 1em;         
            }
        </style>
        
    </head>

    <body>
        <div id="content">

            <h1>Golf Mood Today!</h1>
            <p> Enter your city and state (i.e. city, state)</p>
            <input type="text" id="cityinput" placeholder="city, state">
            <br>
            <button onclick="getGolfMood()">click :D</button>
            <div id="mood"></div>
            <img id="moodImg" src="">
            <div id="data">
                <button onclick="getData()">click for data :DD</button>
            </div> 

        </div>

        <script>
            async function getGolfMood() {
                console.log("Golf Mood clicked!");

                const rawInput = document.getElementById("cityinput").value.trim();
                const moodImg = document.getElementById("moodImg");
                document.getElementById("data").innerHTML = `<button onclick="getData()">click for data :DD</button>`;


                if (!rawInput) {
                    document.getElementById("mood").innerText = "‚ö†Ô∏è Please enter a city and state.";
                    return;
                }

                const apiKey = "b56e0499b9124920af1204141251306";
                const location = encodeURIComponent(rawInput);
                const url = `https://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${location}&aqi=no`;

                try {
                    const response = await fetch(url);

                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }

                    const data = await response.json();
                    
                    const tempF = data.current.temp_f;
                    const weatherText = data.current.condition.text.toLowerCase();
                    const windMph = data.current.wind_mph;

                    let mood = "";
                    let imgSrc = "";

                    if (weatherText.includes("rain") || weatherText.includes("drizzle") || weatherText.includes("thunder")) {
                        mood = "üåßÔ∏è Rain check‚Äîbut you're still tee-rific! üòÅüòÅ";
                        imgSrc = "Images/rainy.png";
                    } else if (tempF > 65 && tempF < 80 && windMph < 12) {
                        mood = "‚òÄÔ∏è Go get your clubs!";
                        imgSrc = "Images/happy.png";
                    } else if (windMph >= 15) {
                        mood = "üí® Windy day üòûüòû";
                        imgSrc = "Images/windy.png";
                    } else if (tempF < 50) {
                        mood = "‚ùÑÔ∏è Too chilly ‚Äî cuddles instead ‚ù§Ô∏è";
                        imgSrc = "Images/cold.png";
                    } else if (tempF > 80) {
                        mood = "üî• It's too hot, your clubs will start melting"
                        imgSrc = "Images/hot.png";
                    } else {
                        mood = "ü§î Not ideal, but the course could still be fun!";
                        imgSrc = "Images/neutral.png";
                    }

                    document.getElementById("mood").innerText = mood;

                    moodImg.src = imgSrc;
                    moodImg.style.display = "block";

                    } catch (error) {
                        console.error(error);
                        document.getElementById("mood").innerText = "‚ö†Ô∏è Couldn't get the weather. Try another city.";
                    }
            }

            async function getData() {
                console.log("clicked getData");

                const rawInput = document.getElementById("cityinput").value.trim();
                const dataOutput = document.getElementById("data");

                if (!rawInput) {
                    document.getElementById("mood").innerText = "‚ö†Ô∏è Please enter a city and state.";
                    return;
                }

                const apiKey = "b56e0499b9124920af1204141251306";
                const location = encodeURIComponent(rawInput);
                const url = `https://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${location}&aqi=no`;

                try {
                    const response = await fetch(url);

                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }

                    const data = await response.json();

                    const tempF = data.current.temp_f;
                    const feelsLike = data.current.feelslike_f;
                    const weatherText = data.current.condition.text.toLowerCase();
                    const windDir = data.current.wind_degree;
                    const windMph = data.current.wind_mph;
                    const humidity = data.current.humidity;

                    const weatherInfo = `
                        <p><strong>Temperature:</strong> ${tempF} ¬∞F (feels like ${feelsLike} ¬∞F)</p>
                        <p><strong>-> unreliable :D -> Wind (not gusts!):</strong> ${windMph} mph ${windDir}</p>
                        <p><strong>Humidity:</strong> ${humidity}%</p>
                        <p><strong>Condition:</strong> ${weatherText}</p>
                    `;

                    dataOutput.innerHTML = `<button onclick="getData()">click for data :DD</button>` + weatherInfo;

                } catch (error) {
                    console.error(error);
                    dataOutput.innerHTML = `<p>‚ö†Ô∏è Couldn't load weather data. Try again!</p>`;
                }
            }

            function setSeasonalBackgroundImage() {
                const month = new Date().getMonth() + 1; // 1-12
                let imageUrl = "";

                if (month >= 3 && month <= 5) {
                    imageUrl = "Images/spring.png";
                } else if (month >= 6 && month <= 8) {
                    imageUrl = "Images/summer.png";
                } else if (month >= 9 && month <= 11) {
                    imageUrl = "Images/autumn.png";
                } else {
                    imageUrl = "Images/winter.png";
                }

                document.body.style.backgroundImage = `url('${imageUrl}')`;
                document.body.style.backgroundSize = "cover"; 
                document.body.style.backgroundPosition = "center center";
                document.body.style.backgroundRepeat = "no-repeat";
            }

            setSeasonalBackgroundImage();


        </script>

    </body>


</html>
